'use strict';function cov_27fb15lw63(){var path="C:\\Users\\jmmar\\OneDrive\\Documentos\\Documents\\INGENIERIA INFORM\xC1TICA 4\xBA\\2DO CUATRIMESTRE\\TFG\\repo\\red-social\\api\\controllers\\track.js";var hash="d47a8647a9aaaf058fa9fb803bb9bff2629aa40d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\jmmar\\OneDrive\\Documentos\\Documents\\INGENIERIA INFORM\xC1TICA 4\xBA\\2DO CUATRIMESTRE\\TFG\\repo\\red-social\\api\\controllers\\track.js",statementMap:{"0":{start:{line:3,column:25},end:{line:3,column:55}},"1":{start:{line:4,column:13},end:{line:4,column:30}},"2":{start:{line:5,column:9},end:{line:5,column:22}},"3":{start:{line:6,column:11},end:{line:6,column:26}},"4":{start:{line:8,column:12},end:{line:8,column:38}},"5":{start:{line:9,column:14},end:{line:9,column:42}},"6":{start:{line:14,column:17},end:{line:14,column:34}},"7":{start:{line:16,column:4},end:{line:16,column:106}},"8":{start:{line:16,column:38},end:{line:16,column:106}},"9":{start:{line:19,column:4},end:{line:50,column:5}},"10":{start:{line:20,column:24},end:{line:20,column:44}},"11":{start:{line:21,column:25},end:{line:21,column:46}},"12":{start:{line:23,column:24},end:{line:23,column:37}},"13":{start:{line:25,column:23},end:{line:25,column:44}},"14":{start:{line:26,column:23},end:{line:26,column:34}},"15":{start:{line:28,column:8},end:{line:47,column:9}},"16":{start:{line:30,column:24},end:{line:30,column:35}},"17":{start:{line:32,column:12},end:{line:32,column:34}},"18":{start:{line:33,column:12},end:{line:33,column:35}},"19":{start:{line:34,column:12},end:{line:34,column:37}},"20":{start:{line:35,column:12},end:{line:35,column:38}},"21":{start:{line:37,column:12},end:{line:43,column:14}},"22":{start:{line:38,column:16},end:{line:38,column:91}},"23":{start:{line:38,column:25},end:{line:38,column:91}},"24":{start:{line:40,column:16},end:{line:40,column:112}},"25":{start:{line:40,column:34},end:{line:40,column:112}},"26":{start:{line:42,column:16},end:{line:42,column:68}},"27":{start:{line:46,column:12},end:{line:46,column:80}},"28":{start:{line:49,column:8},end:{line:49,column:77}},"29":{start:{line:54,column:4},end:{line:57,column:6}},"30":{start:{line:55,column:8},end:{line:55,column:67}},"31":{start:{line:55,column:17},end:{line:55,column:67}},"32":{start:{line:61,column:17},end:{line:61,column:29}},"33":{start:{line:63,column:15},end:{line:63,column:16}},"34":{start:{line:65,column:4},end:{line:67,column:5}},"35":{start:{line:66,column:8},end:{line:66,column:31}},"36":{start:{line:69,column:23},end:{line:69,column:24}},"37":{start:{line:71,column:4},end:{line:81,column:7}},"38":{start:{line:72,column:8},end:{line:72,column:83}},"39":{start:{line:72,column:17},end:{line:72,column:83}},"40":{start:{line:74,column:8},end:{line:74,column:92}},"41":{start:{line:74,column:21},end:{line:74,column:92}},"42":{start:{line:76,column:8},end:{line:80,column:11}},"43":{start:{line:86,column:16},end:{line:86,column:32}},"44":{start:{line:87,column:20},end:{line:87,column:47}},"45":{start:{line:89,column:4},end:{line:96,column:6}},"46":{start:{line:90,column:8},end:{line:95,column:9}},"47":{start:{line:91,column:12},end:{line:91,column:50}},"48":{start:{line:93,column:12},end:{line:93,column:73}},"49":{start:{line:100,column:18},end:{line:100,column:31}},"50":{start:{line:101,column:17},end:{line:101,column:25}},"51":{start:{line:102,column:29},end:{line:102,column:42}},"52":{start:{line:104,column:4},end:{line:108,column:5}},"53":{start:{line:106,column:8},end:{line:106,column:70}},"54":{start:{line:109,column:4},end:{line:109,column:92}},"55":{start:{line:109,column:24},end:{line:109,column:92}},"56":{start:{line:112,column:4},end:{line:138,column:6}},"57":{start:{line:113,column:8},end:{line:113,column:83}},"58":{start:{line:113,column:17},end:{line:113,column:83}},"59":{start:{line:115,column:8},end:{line:115,column:108}},"60":{start:{line:115,column:27},end:{line:115,column:108}},"61":{start:{line:117,column:22},end:{line:117,column:35}},"62":{start:{line:119,column:8},end:{line:119,column:39}},"63":{start:{line:120,column:8},end:{line:120,column:45}},"64":{start:{line:123,column:8},end:{line:127,column:9}},"65":{start:{line:124,column:12},end:{line:124,column:34}},"66":{start:{line:126,column:12},end:{line:126,column:34}},"67":{start:{line:128,column:8},end:{line:128,column:54}},"68":{start:{line:129,column:8},end:{line:129,column:45}},"69":{start:{line:130,column:8},end:{line:130,column:31}},"70":{start:{line:132,column:8},end:{line:135,column:10}},"71":{start:{line:133,column:12},end:{line:133,column:80}},"72":{start:{line:133,column:21},end:{line:133,column:80}},"73":{start:{line:134,column:12},end:{line:134,column:100}},"74":{start:{line:134,column:32},end:{line:134,column:100}},"75":{start:{line:137,column:8},end:{line:137,column:61}},"76":{start:{line:143,column:29},end:{line:143,column:42}},"77":{start:{line:144,column:4},end:{line:148,column:5}},"78":{start:{line:146,column:8},end:{line:146,column:70}},"79":{start:{line:150,column:15},end:{line:150,column:16}},"80":{start:{line:152,column:4},end:{line:154,column:5}},"81":{start:{line:153,column:8},end:{line:153,column:31}},"82":{start:{line:156,column:23},end:{line:156,column:24}},"83":{start:{line:158,column:4},end:{line:168,column:7}},"84":{start:{line:159,column:8},end:{line:159,column:83}},"85":{start:{line:159,column:17},end:{line:159,column:83}},"86":{start:{line:161,column:8},end:{line:161,column:92}},"87":{start:{line:161,column:21},end:{line:161,column:92}},"88":{start:{line:163,column:8},end:{line:167,column:11}},"89":{start:{line:172,column:0},end:{line:180,column:1}}},fnMap:{"0":{name:"uploadTrack",decl:{start:{line:13,column:9},end:{line:13,column:20}},loc:{start:{line:13,column:31},end:{line:51,column:1}},line:13},"1":{name:"(anonymous_1)",decl:{start:{line:37,column:23},end:{line:37,column:24}},loc:{start:{line:37,column:45},end:{line:43,column:13}},line:37},"2":{name:"removeFilesOfUploads",decl:{start:{line:53,column:9},end:{line:53,column:29}},loc:{start:{line:53,column:55},end:{line:58,column:1}},line:53},"3":{name:"(anonymous_3)",decl:{start:{line:54,column:25},end:{line:54,column:26}},loc:{start:{line:54,column:34},end:{line:57,column:5}},line:54},"4":{name:"getMyTracks",decl:{start:{line:60,column:9},end:{line:60,column:20}},loc:{start:{line:60,column:31},end:{line:82,column:1}},line:60},"5":{name:"(anonymous_5)",decl:{start:{line:71,column:79},end:{line:71,column:80}},loc:{start:{line:71,column:103},end:{line:81,column:5}},line:71},"6":{name:"getTrackFile",decl:{start:{line:85,column:9},end:{line:85,column:21}},loc:{start:{line:85,column:32},end:{line:97,column:1}},line:85},"7":{name:"(anonymous_7)",decl:{start:{line:89,column:25},end:{line:89,column:26}},loc:{start:{line:89,column:36},end:{line:96,column:5}},line:89},"8":{name:"updateTrack",decl:{start:{line:99,column:9},end:{line:99,column:20}},loc:{start:{line:99,column:31},end:{line:139,column:1}},line:99},"9":{name:"(anonymous_9)",decl:{start:{line:112,column:60},end:{line:112,column:61}},loc:{start:{line:112,column:83},end:{line:138,column:5}},line:112},"10":{name:"(anonymous_10)",decl:{start:{line:132,column:21},end:{line:132,column:22}},loc:{start:{line:132,column:45},end:{line:135,column:9}},line:132},"11":{name:"getTracks",decl:{start:{line:142,column:9},end:{line:142,column:18}},loc:{start:{line:142,column:29},end:{line:170,column:1}},line:142},"12":{name:"(anonymous_12)",decl:{start:{line:158,column:78},end:{line:158,column:79}},loc:{start:{line:158,column:102},end:{line:168,column:5}},line:158}},branchMap:{"0":{loc:{start:{line:16,column:4},end:{line:16,column:106}},type:"if",locations:[{start:{line:16,column:4},end:{line:16,column:106}},{start:{line:16,column:4},end:{line:16,column:106}}],line:16},"1":{loc:{start:{line:16,column:8},end:{line:16,column:36}},type:"binary-expr",locations:[{start:{line:16,column:8},end:{line:16,column:22}},{start:{line:16,column:26},end:{line:16,column:36}}],line:16},"2":{loc:{start:{line:19,column:4},end:{line:50,column:5}},type:"if",locations:[{start:{line:19,column:4},end:{line:50,column:5}},{start:{line:19,column:4},end:{line:50,column:5}}],line:19},"3":{loc:{start:{line:28,column:8},end:{line:47,column:9}},type:"if",locations:[{start:{line:28,column:8},end:{line:47,column:9}},{start:{line:28,column:8},end:{line:47,column:9}}],line:28},"4":{loc:{start:{line:38,column:16},end:{line:38,column:91}},type:"if",locations:[{start:{line:38,column:16},end:{line:38,column:91}},{start:{line:38,column:16},end:{line:38,column:91}}],line:38},"5":{loc:{start:{line:40,column:16},end:{line:40,column:112}},type:"if",locations:[{start:{line:40,column:16},end:{line:40,column:112}},{start:{line:40,column:16},end:{line:40,column:112}}],line:40},"6":{loc:{start:{line:55,column:8},end:{line:55,column:67}},type:"if",locations:[{start:{line:55,column:8},end:{line:55,column:67}},{start:{line:55,column:8},end:{line:55,column:67}}],line:55},"7":{loc:{start:{line:65,column:4},end:{line:67,column:5}},type:"if",locations:[{start:{line:65,column:4},end:{line:67,column:5}},{start:{line:65,column:4},end:{line:67,column:5}}],line:65},"8":{loc:{start:{line:72,column:8},end:{line:72,column:83}},type:"if",locations:[{start:{line:72,column:8},end:{line:72,column:83}},{start:{line:72,column:8},end:{line:72,column:83}}],line:72},"9":{loc:{start:{line:74,column:8},end:{line:74,column:92}},type:"if",locations:[{start:{line:74,column:8},end:{line:74,column:92}},{start:{line:74,column:8},end:{line:74,column:92}}],line:74},"10":{loc:{start:{line:90,column:8},end:{line:95,column:9}},type:"if",locations:[{start:{line:90,column:8},end:{line:95,column:9}},{start:{line:90,column:8},end:{line:95,column:9}}],line:90},"11":{loc:{start:{line:104,column:4},end:{line:108,column:5}},type:"if",locations:[{start:{line:104,column:4},end:{line:108,column:5}},{start:{line:104,column:4},end:{line:108,column:5}}],line:104},"12":{loc:{start:{line:109,column:4},end:{line:109,column:92}},type:"if",locations:[{start:{line:109,column:4},end:{line:109,column:92}},{start:{line:109,column:4},end:{line:109,column:92}}],line:109},"13":{loc:{start:{line:113,column:8},end:{line:113,column:83}},type:"if",locations:[{start:{line:113,column:8},end:{line:113,column:83}},{start:{line:113,column:8},end:{line:113,column:83}}],line:113},"14":{loc:{start:{line:115,column:8},end:{line:115,column:108}},type:"if",locations:[{start:{line:115,column:8},end:{line:115,column:108}},{start:{line:115,column:8},end:{line:115,column:108}}],line:115},"15":{loc:{start:{line:123,column:8},end:{line:127,column:9}},type:"if",locations:[{start:{line:123,column:8},end:{line:127,column:9}},{start:{line:123,column:8},end:{line:127,column:9}}],line:123},"16":{loc:{start:{line:133,column:12},end:{line:133,column:80}},type:"if",locations:[{start:{line:133,column:12},end:{line:133,column:80}},{start:{line:133,column:12},end:{line:133,column:80}}],line:133},"17":{loc:{start:{line:134,column:12},end:{line:134,column:100}},type:"if",locations:[{start:{line:134,column:12},end:{line:134,column:100}},{start:{line:134,column:12},end:{line:134,column:100}}],line:134},"18":{loc:{start:{line:144,column:4},end:{line:148,column:5}},type:"if",locations:[{start:{line:144,column:4},end:{line:148,column:5}},{start:{line:144,column:4},end:{line:148,column:5}}],line:144},"19":{loc:{start:{line:152,column:4},end:{line:154,column:5}},type:"if",locations:[{start:{line:152,column:4},end:{line:154,column:5}},{start:{line:152,column:4},end:{line:154,column:5}}],line:152},"20":{loc:{start:{line:159,column:8},end:{line:159,column:83}},type:"if",locations:[{start:{line:159,column:8},end:{line:159,column:83}},{start:{line:159,column:8},end:{line:159,column:83}}],line:159},"21":{loc:{start:{line:161,column:8},end:{line:161,column:92}},type:"if",locations:[{start:{line:161,column:8},end:{line:161,column:92}},{start:{line:161,column:8},end:{line:161,column:92}}],line:161}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d47a8647a9aaaf058fa9fb803bb9bff2629aa40d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_27fb15lw63=function(){return actualCoverage;};return actualCoverage;}cov_27fb15lw63();var mongoosePagination=(cov_27fb15lw63().s[0]++,require('mongoose-pagination'));var moment=(cov_27fb15lw63().s[1]++,require('moment'));var fs=(cov_27fb15lw63().s[2]++,require('fs'));var path=(cov_27fb15lw63().s[3]++,require('path'));var Track=(cov_27fb15lw63().s[4]++,require('../models/track'));var Message=(cov_27fb15lw63().s[5]++,require('../models/message'));function uploadTrack(req,res){cov_27fb15lw63().f[0]++;var titulo=(cov_27fb15lw63().s[6]++,req.params.titulo);cov_27fb15lw63().s[7]++;if((cov_27fb15lw63().b[1][0]++,!params.titulo)||(cov_27fb15lw63().b[1][1]++,!req.files)){cov_27fb15lw63().b[0][0]++;cov_27fb15lw63().s[8]++;return res.status(200).send({message:"Enviar datos necesarios."});}else{cov_27fb15lw63().b[0][1]++;}cov_27fb15lw63().s[9]++;if(req.files){cov_27fb15lw63().b[2][0]++;var file_path=(cov_27fb15lw63().s[10]++,req.files.track.path);var file_split=(cov_27fb15lw63().s[11]++,file_path.split('\\'));var file_name=(cov_27fb15lw63().s[12]++,file_split[2]);var ext_file=(cov_27fb15lw63().s[13]++,file_name.split('\.'));var file_ext=(cov_27fb15lw63().s[14]++,ext_file[1]);cov_27fb15lw63().s[15]++;if(file_ext=='mp3'){cov_27fb15lw63().b[3][0]++;var track=(cov_27fb15lw63().s[16]++,new Track());cov_27fb15lw63().s[17]++;track.titulo=titulo;cov_27fb15lw63().s[18]++;track.file=file_name;cov_27fb15lw63().s[19]++;track.status="PENDING";cov_27fb15lw63().s[20]++;track.user=req.user.sub;cov_27fb15lw63().s[21]++;track.save((err,trackStored)=>{cov_27fb15lw63().f[1]++;cov_27fb15lw63().s[22]++;if(err){cov_27fb15lw63().b[4][0]++;cov_27fb15lw63().s[23]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_27fb15lw63().b[4][1]++;}cov_27fb15lw63().s[24]++;if(!trackStored){cov_27fb15lw63().b[5][0]++;cov_27fb15lw63().s[25]++;return res.status(404).send({message:'No se ha podido guardar la pista.'});}else{cov_27fb15lw63().b[5][1]++;}cov_27fb15lw63().s[26]++;return res.status(200).send({track:trackStored});});}else{cov_27fb15lw63().b[3][1]++;cov_27fb15lw63().s[27]++;return removeFilesOfUploads(res,file_path,'Extensión no válida.');}}else{cov_27fb15lw63().b[2][1]++;cov_27fb15lw63().s[28]++;return res.status(500).send({message:'No se han subido tracks.'});}}function removeFilesOfUploads(res,file_path,message){cov_27fb15lw63().f[2]++;cov_27fb15lw63().s[29]++;fs.unlink(file_path,err=>{cov_27fb15lw63().f[3]++;cov_27fb15lw63().s[30]++;if(err){cov_27fb15lw63().b[6][0]++;cov_27fb15lw63().s[31]++;return res.status(500).send({message:message});}else{cov_27fb15lw63().b[6][1]++;}});}function getMyTracks(req,res){cov_27fb15lw63().f[4]++;var userId=(cov_27fb15lw63().s[32]++,req.user.sub);var page=(cov_27fb15lw63().s[33]++,1);cov_27fb15lw63().s[34]++;if(req.params.page){cov_27fb15lw63().b[7][0]++;cov_27fb15lw63().s[35]++;page=req.params.page;}else{cov_27fb15lw63().b[7][1]++;}var itemsPerPage=(cov_27fb15lw63().s[36]++,5);cov_27fb15lw63().s[37]++;Track.find({user:userId}).populate('user').paginate(page,itemsPerPage,(err,tracks,total)=>{cov_27fb15lw63().f[5]++;cov_27fb15lw63().s[38]++;if(err){cov_27fb15lw63().b[8][0]++;cov_27fb15lw63().s[39]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_27fb15lw63().b[8][1]++;}cov_27fb15lw63().s[40]++;if(!tracks){cov_27fb15lw63().b[9][0]++;cov_27fb15lw63().s[41]++;return res.status(404).send({message:'No hay pistas disponibles.'});}else{cov_27fb15lw63().b[9][1]++;}cov_27fb15lw63().s[42]++;return res.status(200).send({tracks,total,pages:Math.ceil(total/itemsPerPage)});});}function getTrackFile(req,res){cov_27fb15lw63().f[6]++;var track=(cov_27fb15lw63().s[43]++,req.params.track);var path_file=(cov_27fb15lw63().s[44]++,'./uploads/tracks/'+track);cov_27fb15lw63().s[45]++;fs.exists(path_file,exits=>{cov_27fb15lw63().f[7]++;cov_27fb15lw63().s[46]++;if(exits){cov_27fb15lw63().b[10][0]++;cov_27fb15lw63().s[47]++;res.sendFile(path.resolve(path_file));}else{cov_27fb15lw63().b[10][1]++;cov_27fb15lw63().s[48]++;return res.status(500).send({message:'No existe track.'});}});}function updateTrack(req,res){cov_27fb15lw63().f[8]++;var trackId=(cov_27fb15lw63().s[49]++,req.params.id);var update=(cov_27fb15lw63().s[50]++,req.body);var identity_user_role=(cov_27fb15lw63().s[51]++,req.user.role);cov_27fb15lw63().s[52]++;if(identity_user_role!='ROLE_ADMIN'){cov_27fb15lw63().b[11][0]++;cov_27fb15lw63().s[53]++;return res.status(403).send({message:'No tienes acceso.'});}else{cov_27fb15lw63().b[11][1]++;}cov_27fb15lw63().s[54]++;if(!update.status){cov_27fb15lw63().b[12][0]++;cov_27fb15lw63().s[55]++;return res.status(200).send({message:"Enviar datos necesarios."});}else{cov_27fb15lw63().b[12][1]++;}cov_27fb15lw63().s[56]++;Track.findByIdAndUpdate(trackId,update,{new:true},(err,trackUpdated)=>{cov_27fb15lw63().f[9]++;cov_27fb15lw63().s[57]++;if(err){cov_27fb15lw63().b[13][0]++;cov_27fb15lw63().s[58]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_27fb15lw63().b[13][1]++;}cov_27fb15lw63().s[59]++;if(!trackUpdated){cov_27fb15lw63().b[14][0]++;cov_27fb15lw63().s[60]++;return res.status(404).send({message:'No se ha podido actualizar el track.'});}else{cov_27fb15lw63().b[14][1]++;}var message=(cov_27fb15lw63().s[61]++,new Message());cov_27fb15lw63().s[62]++;message.emitter=req.user.sub;cov_27fb15lw63().s[63]++;message.receiver=trackUpdated.user;var statusES;cov_27fb15lw63().s[64]++;if(trackUpdated.status=='ACCEPTED'){cov_27fb15lw63().b[15][0]++;cov_27fb15lw63().s[65]++;statusES="ACEPTADO";}else{cov_27fb15lw63().b[15][1]++;cov_27fb15lw63().s[66]++;statusES="RECHAZADO";}cov_27fb15lw63().s[67]++;message.text="Su pista ha sido "+statusES;cov_27fb15lw63().s[68]++;message.created_at=moment().unix();cov_27fb15lw63().s[69]++;message.viewed=false;cov_27fb15lw63().s[70]++;message.save((err,messageStored)=>{cov_27fb15lw63().f[10]++;cov_27fb15lw63().s[71]++;if(err){cov_27fb15lw63().b[16][0]++;cov_27fb15lw63().s[72]++;return res.status(500).send({message:"Error petición."});}else{cov_27fb15lw63().b[16][1]++;}cov_27fb15lw63().s[73]++;if(!messageStored){cov_27fb15lw63().b[17][0]++;cov_27fb15lw63().s[74]++;return res.status(404).send({message:"Error al enviar mensaje."});}else{cov_27fb15lw63().b[17][1]++;}});cov_27fb15lw63().s[75]++;return res.status(200).send({track:trackUpdated});});}//Usuarios paginados
function getTracks(req,res){cov_27fb15lw63().f[11]++;var identity_user_role=(cov_27fb15lw63().s[76]++,req.user.role);cov_27fb15lw63().s[77]++;if(identity_user_role!='ROLE_ADMIN'){cov_27fb15lw63().b[18][0]++;cov_27fb15lw63().s[78]++;return res.status(403).send({message:'No tienes acceso.'});}else{cov_27fb15lw63().b[18][1]++;}var page=(cov_27fb15lw63().s[79]++,1);cov_27fb15lw63().s[80]++;if(req.params.page){cov_27fb15lw63().b[19][0]++;cov_27fb15lw63().s[81]++;page=req.params.page;}else{cov_27fb15lw63().b[19][1]++;}var itemsPerPage=(cov_27fb15lw63().s[82]++,5);cov_27fb15lw63().s[83]++;Track.find().sort('titulo').populate('user').paginate(page,itemsPerPage,(err,tracks,total)=>{cov_27fb15lw63().f[12]++;cov_27fb15lw63().s[84]++;if(err){cov_27fb15lw63().b[20][0]++;cov_27fb15lw63().s[85]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_27fb15lw63().b[20][1]++;}cov_27fb15lw63().s[86]++;if(!tracks){cov_27fb15lw63().b[21][0]++;cov_27fb15lw63().s[87]++;return res.status(404).send({message:'No hay pistas disponibles.'});}else{cov_27fb15lw63().b[21][1]++;}cov_27fb15lw63().s[88]++;return res.status(200).send({tracks,total,pages:Math.ceil(total/itemsPerPage)});});}cov_27fb15lw63().s[89]++;module.exports={uploadTrack,getMyTracks,getTrackFile,updateTrack,getTracks};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRyYWNrLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlUGFnaW5hdGlvbiIsInJlcXVpcmUiLCJtb21lbnQiLCJmcyIsInBhdGgiLCJUcmFjayIsIk1lc3NhZ2UiLCJ1cGxvYWRUcmFjayIsInJlcSIsInJlcyIsInRpdHVsbyIsInBhcmFtcyIsImZpbGVzIiwic3RhdHVzIiwic2VuZCIsIm1lc3NhZ2UiLCJmaWxlX3BhdGgiLCJ0cmFjayIsImZpbGVfc3BsaXQiLCJzcGxpdCIsImZpbGVfbmFtZSIsImV4dF9maWxlIiwiZmlsZV9leHQiLCJmaWxlIiwidXNlciIsInN1YiIsInNhdmUiLCJlcnIiLCJ0cmFja1N0b3JlZCIsInJlbW92ZUZpbGVzT2ZVcGxvYWRzIiwidW5saW5rIiwiZ2V0TXlUcmFja3MiLCJ1c2VySWQiLCJwYWdlIiwiaXRlbXNQZXJQYWdlIiwiZmluZCIsInBvcHVsYXRlIiwicGFnaW5hdGUiLCJ0cmFja3MiLCJ0b3RhbCIsInBhZ2VzIiwiTWF0aCIsImNlaWwiLCJnZXRUcmFja0ZpbGUiLCJwYXRoX2ZpbGUiLCJleGlzdHMiLCJleGl0cyIsInNlbmRGaWxlIiwicmVzb2x2ZSIsInVwZGF0ZVRyYWNrIiwidHJhY2tJZCIsImlkIiwidXBkYXRlIiwiYm9keSIsImlkZW50aXR5X3VzZXJfcm9sZSIsInJvbGUiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm5ldyIsInRyYWNrVXBkYXRlZCIsImVtaXR0ZXIiLCJyZWNlaXZlciIsInN0YXR1c0VTIiwidGV4dCIsImNyZWF0ZWRfYXQiLCJ1bml4Iiwidmlld2VkIiwibWVzc2FnZVN0b3JlZCIsImdldFRyYWNrcyIsInNvcnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxhLG03WkFFQSxHQUFJQSxDQUFBQSxrQkFBa0IsMEJBQUdDLE9BQU8sQ0FBQyxxQkFBRCxDQUFWLENBQXRCLENBQ0EsR0FBSUMsQ0FBQUEsTUFBTSwwQkFBR0QsT0FBTyxDQUFDLFFBQUQsQ0FBVixDQUFWLENBQ0Es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Q0FBQ0ksTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLENBQ3hCd0IsTUFEd0IsQ0FFeEJDLEtBRndCLENBR3hCQyxLQUFLLENBQUVDLElBQUksQ0FBQ0MsSUFBTCxDQUFVSCxLQUFLLENBQUdMLFlBQWxCLENBSGlCLENBQXJCLENBQVAsQ0FLSCxDQVZELEVBWUgsQyx5QkFFRG1DLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUViL0QsV0FGYSxDQUdid0IsV0FIYSxDQUliWSxZQUphLENBS2JNLFdBTGEsQ0FNYmtCLFNBTmEsQ0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcclxuXHJcbnZhciBtb25nb29zZVBhZ2luYXRpb24gPSByZXF1aXJlKCdtb25nb29zZS1wYWdpbmF0aW9uJyk7XHJcbnZhciBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQnKTtcclxudmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcclxudmFyIHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcblxyXG52YXIgVHJhY2sgPSByZXF1aXJlKCcuLi9tb2RlbHMvdHJhY2snKTtcclxudmFyIE1lc3NhZ2UgPSByZXF1aXJlKCcuLi9tb2RlbHMvbWVzc2FnZScpO1xyXG5cclxuXHJcblxyXG5mdW5jdGlvbiB1cGxvYWRUcmFjayhyZXEsIHJlcykge1xyXG4gICAgdmFyIHRpdHVsbyA9IHJlcS5wYXJhbXMudGl0dWxvO1xyXG5cclxuICAgIGlmICghcGFyYW1zLnRpdHVsbyB8fCAhcmVxLmZpbGVzKSByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBtZXNzYWdlOiBcIkVudmlhciBkYXRvcyBuZWNlc2FyaW9zLlwiIH0pXHJcblxyXG5cclxuICAgIGlmIChyZXEuZmlsZXMpIHtcclxuICAgICAgICB2YXIgZmlsZV9wYXRoID0gcmVxLmZpbGVzLnRyYWNrLnBhdGg7XHJcbiAgICAgICAgdmFyIGZpbGVfc3BsaXQgPSBmaWxlX3BhdGguc3BsaXQoJ1xcXFwnKTtcclxuXHJcbiAgICAgICAgdmFyIGZpbGVfbmFtZSA9IGZpbGVfc3BsaXRbMl07XHJcblxyXG4gICAgICAgIHZhciBleHRfZmlsZSA9IGZpbGVfbmFtZS5zcGxpdCgnXFwuJyk7XHJcbiAgICAgICAgdmFyIGZpbGVfZXh0ID0gZXh0X2ZpbGVbMV07XHJcblxyXG4gICAgICAgIGlmIChmaWxlX2V4dCA9PSAnbXAzJykge1xyXG5cclxuICAgICAgICAgICAgdmFyIHRyYWNrID0gbmV3IFRyYWNrKCk7XHJcblxyXG4gICAgICAgICAgICB0cmFjay50aXR1bG8gPSB0aXR1bG87XHJcbiAgICAgICAgICAgIHRyYWNrLmZpbGUgPSBmaWxlX25hbWU7XHJcbiAgICAgICAgICAgIHRyYWNrLnN0YXR1cyA9IFwiUEVORElOR1wiO1xyXG4gICAgICAgICAgICB0cmFjay51c2VyID0gcmVxLnVzZXIuc3ViO1xyXG5cclxuICAgICAgICAgICAgdHJhY2suc2F2ZSgoZXJyLCB0cmFja1N0b3JlZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ0Vycm9yIGVuIGxhIHBldGljacOzbi4nIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghdHJhY2tTdG9yZWQpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdObyBzZSBoYSBwb2RpZG8gZ3VhcmRhciBsYSBwaXN0YS4nIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IHRyYWNrOiB0cmFja1N0b3JlZCB9KTtcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZUZpbGVzT2ZVcGxvYWRzKHJlcywgZmlsZV9wYXRoLCAnRXh0ZW5zacOzbiBubyB2w6FsaWRhLicpO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ05vIHNlIGhhbiBzdWJpZG8gdHJhY2tzLicgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZUZpbGVzT2ZVcGxvYWRzKHJlcywgZmlsZV9wYXRoLCBtZXNzYWdlKSB7XHJcbiAgICBmcy51bmxpbmsoZmlsZV9wYXRoLCAoZXJyKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogbWVzc2FnZSB9KTtcclxuXHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRNeVRyYWNrcyhyZXEsIHJlcykge1xyXG4gICAgdmFyIHVzZXJJZCA9IHJlcS51c2VyLnN1YjtcclxuXHJcbiAgICB2YXIgcGFnZSA9IDE7XHJcblxyXG4gICAgaWYgKHJlcS5wYXJhbXMucGFnZSkge1xyXG4gICAgICAgIHBhZ2UgPSByZXEucGFyYW1zLnBhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGl0ZW1zUGVyUGFnZSA9IDU7XHJcblxyXG4gICAgVHJhY2suZmluZCh7IHVzZXI6IHVzZXJJZCB9KS5wb3B1bGF0ZSgndXNlcicpLnBhZ2luYXRlKHBhZ2UsIGl0ZW1zUGVyUGFnZSwgKGVyciwgdHJhY2tzLCB0b3RhbCkgPT4ge1xyXG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IG1lc3NhZ2U6ICdFcnJvciBlbiBsYSBwZXRpY2nDs24uJyB9KTtcclxuXHJcbiAgICAgICAgaWYgKCF0cmFja3MpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdObyBoYXkgcGlzdGFzIGRpc3BvbmlibGVzLicgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgIHRyYWNrcyxcclxuICAgICAgICAgICAgdG90YWwsXHJcbiAgICAgICAgICAgIHBhZ2VzOiBNYXRoLmNlaWwodG90YWwgLyBpdGVtc1BlclBhZ2UpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGdldFRyYWNrRmlsZShyZXEsIHJlcykge1xyXG4gICAgdmFyIHRyYWNrID0gcmVxLnBhcmFtcy50cmFjaztcclxuICAgIHZhciBwYXRoX2ZpbGUgPSAnLi91cGxvYWRzL3RyYWNrcy8nICsgdHJhY2s7XHJcblxyXG4gICAgZnMuZXhpc3RzKHBhdGhfZmlsZSwgKGV4aXRzKSA9PiB7XHJcbiAgICAgICAgaWYgKGV4aXRzKSB7XHJcbiAgICAgICAgICAgIHJlcy5zZW5kRmlsZShwYXRoLnJlc29sdmUocGF0aF9maWxlKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ05vIGV4aXN0ZSB0cmFjay4nIH0pO1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVUcmFjayhyZXEsIHJlcykge1xyXG4gICAgdmFyIHRyYWNrSWQgPSByZXEucGFyYW1zLmlkO1xyXG4gICAgdmFyIHVwZGF0ZSA9IHJlcS5ib2R5O1xyXG4gICAgdmFyIGlkZW50aXR5X3VzZXJfcm9sZSA9IHJlcS51c2VyLnJvbGU7XHJcblxyXG4gICAgaWYgKGlkZW50aXR5X3VzZXJfcm9sZSAhPSAnUk9MRV9BRE1JTicpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKHsgbWVzc2FnZTogJ05vIHRpZW5lcyBhY2Nlc28uJyB9KTtcclxuXHJcbiAgICB9XHJcbiAgICBpZiAoIXVwZGF0ZS5zdGF0dXMpIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IG1lc3NhZ2U6IFwiRW52aWFyIGRhdG9zIG5lY2VzYXJpb3MuXCIgfSlcclxuXHJcblxyXG4gICAgVHJhY2suZmluZEJ5SWRBbmRVcGRhdGUodHJhY2tJZCwgdXBkYXRlLCB7IG5ldzogdHJ1ZSB9LCAoZXJyLCB0cmFja1VwZGF0ZWQpID0+IHtcclxuICAgICAgICBpZiAoZXJyKSByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBtZXNzYWdlOiAnRXJyb3IgZW4gbGEgcGV0aWNpw7NuLicgfSk7XHJcblxyXG4gICAgICAgIGlmICghdHJhY2tVcGRhdGVkKSByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoeyBtZXNzYWdlOiAnTm8gc2UgaGEgcG9kaWRvIGFjdHVhbGl6YXIgZWwgdHJhY2suJyB9KTtcclxuXHJcbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBuZXcgTWVzc2FnZSgpO1xyXG5cclxuICAgICAgICBtZXNzYWdlLmVtaXR0ZXIgPSByZXEudXNlci5zdWI7XHJcbiAgICAgICAgbWVzc2FnZS5yZWNlaXZlciA9IHRyYWNrVXBkYXRlZC51c2VyO1xyXG5cclxuICAgICAgICB2YXIgc3RhdHVzRVM7XHJcbiAgICAgICAgaWYgKHRyYWNrVXBkYXRlZC5zdGF0dXMgPT0gJ0FDQ0VQVEVEJykge1xyXG4gICAgICAgICAgICBzdGF0dXNFUyA9IFwiQUNFUFRBRE9cIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdGF0dXNFUyA9IFwiUkVDSEFaQURPXCJcclxuICAgICAgICB9XHJcbiAgICAgICAgbWVzc2FnZS50ZXh0ID0gXCJTdSBwaXN0YSBoYSBzaWRvIFwiICsgc3RhdHVzRVM7XHJcbiAgICAgICAgbWVzc2FnZS5jcmVhdGVkX2F0ID0gbW9tZW50KCkudW5peCgpO1xyXG4gICAgICAgIG1lc3NhZ2Uudmlld2VkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIG1lc3NhZ2Uuc2F2ZSgoZXJyLCBtZXNzYWdlU3RvcmVkKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IG1lc3NhZ2U6IFwiRXJyb3IgcGV0aWNpw7NuLlwiIH0pXHJcbiAgICAgICAgICAgIGlmICghbWVzc2FnZVN0b3JlZCkgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHsgbWVzc2FnZTogXCJFcnJvciBhbCBlbnZpYXIgbWVuc2FqZS5cIiB9KVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IHRyYWNrOiB0cmFja1VwZGF0ZWQgfSk7XHJcbiAgICB9KVxyXG59XHJcblxyXG4vL1VzdWFyaW9zIHBhZ2luYWRvc1xyXG5mdW5jdGlvbiBnZXRUcmFja3MocmVxLCByZXMpIHtcclxuICAgIHZhciBpZGVudGl0eV91c2VyX3JvbGUgPSByZXEudXNlci5yb2xlO1xyXG4gICAgaWYgKGlkZW50aXR5X3VzZXJfcm9sZSAhPSAnUk9MRV9BRE1JTicpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKHsgbWVzc2FnZTogJ05vIHRpZW5lcyBhY2Nlc28uJyB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIHBhZ2UgPSAxO1xyXG5cclxuICAgIGlmIChyZXEucGFyYW1zLnBhZ2UpIHtcclxuICAgICAgICBwYWdlID0gcmVxLnBhcmFtcy5wYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBpdGVtc1BlclBhZ2UgPSA1O1xyXG5cclxuICAgIFRyYWNrLmZpbmQoKS5zb3J0KCd0aXR1bG8nKS5wb3B1bGF0ZSgndXNlcicpLnBhZ2luYXRlKHBhZ2UsIGl0ZW1zUGVyUGFnZSwgKGVyciwgdHJhY2tzLCB0b3RhbCkgPT4ge1xyXG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IG1lc3NhZ2U6ICdFcnJvciBlbiBsYSBwZXRpY2nDs24uJyB9KTtcclxuXHJcbiAgICAgICAgaWYgKCF0cmFja3MpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdObyBoYXkgcGlzdGFzIGRpc3BvbmlibGVzLicgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgIHRyYWNrcyxcclxuICAgICAgICAgICAgdG90YWwsXHJcbiAgICAgICAgICAgIHBhZ2VzOiBNYXRoLmNlaWwodG90YWwgLyBpdGVtc1BlclBhZ2UpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgIHVwbG9hZFRyYWNrLFxyXG4gICAgZ2V0TXlUcmFja3MsXHJcbiAgICBnZXRUcmFja0ZpbGUsXHJcbiAgICB1cGRhdGVUcmFjayxcclxuICAgIGdldFRyYWNrc1xyXG5cclxufSJdfQ==