'use strict';function cov_6056gmrza(){var path="C:\\Users\\jmmar\\OneDrive\\Documentos\\Documents\\INGENIERIA INFORM\xC1TICA 4\xBA\\2DO CUATRIMESTRE\\TFG\\repo\\red-social\\api\\controllers\\artist.js";var hash="92a3fbf072a1591cf48bd4ed30ca8eb1c01e8070";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\jmmar\\OneDrive\\Documentos\\Documents\\INGENIERIA INFORM\xC1TICA 4\xBA\\2DO CUATRIMESTRE\\TFG\\repo\\red-social\\api\\controllers\\artist.js",statementMap:{"0":{start:{line:3,column:25},end:{line:3,column:55}},"1":{start:{line:5,column:13},end:{line:5,column:40}},"2":{start:{line:6,column:11},end:{line:6,column:36}},"3":{start:{line:7,column:18},end:{line:7,column:50}},"4":{start:{line:11,column:17},end:{line:11,column:25}},"5":{start:{line:12,column:29},end:{line:12,column:42}},"6":{start:{line:13,column:4},end:{line:17,column:5}},"7":{start:{line:15,column:8},end:{line:15,column:70}},"8":{start:{line:19,column:4},end:{line:21,column:5}},"9":{start:{line:20,column:8},end:{line:20,column:76}},"10":{start:{line:23,column:17},end:{line:23,column:29}},"11":{start:{line:25,column:4},end:{line:25,column:34}},"12":{start:{line:26,column:4},end:{line:26,column:52}},"13":{start:{line:27,column:4},end:{line:27,column:46}},"14":{start:{line:28,column:4},end:{line:28,column:34}},"15":{start:{line:30,column:4},end:{line:36,column:6}},"16":{start:{line:31,column:8},end:{line:31,column:83}},"17":{start:{line:31,column:17},end:{line:31,column:83}},"18":{start:{line:33,column:8},end:{line:33,column:107}},"19":{start:{line:33,column:27},end:{line:33,column:107}},"20":{start:{line:35,column:8},end:{line:35,column:62}},"21":{start:{line:42,column:19},end:{line:42,column:32}},"22":{start:{line:43,column:17},end:{line:43,column:25}},"23":{start:{line:44,column:29},end:{line:44,column:42}},"24":{start:{line:46,column:4},end:{line:50,column:5}},"25":{start:{line:48,column:8},end:{line:48,column:70}},"26":{start:{line:51,column:4},end:{line:53,column:5}},"27":{start:{line:52,column:8},end:{line:52,column:76}},"28":{start:{line:55,column:4},end:{line:61,column:6}},"29":{start:{line:56,column:8},end:{line:56,column:83}},"30":{start:{line:56,column:17},end:{line:56,column:83}},"31":{start:{line:58,column:8},end:{line:58,column:111}},"32":{start:{line:58,column:28},end:{line:58,column:111}},"33":{start:{line:60,column:8},end:{line:60,column:63}},"34":{start:{line:65,column:19},end:{line:65,column:32}},"35":{start:{line:67,column:4},end:{line:74,column:6}},"36":{start:{line:68,column:8},end:{line:68,column:77}},"37":{start:{line:68,column:17},end:{line:68,column:77}},"38":{start:{line:70,column:8},end:{line:70,column:87}},"39":{start:{line:70,column:21},end:{line:70,column:87}},"40":{start:{line:72,column:8},end:{line:72,column:55}},"41":{start:{line:79,column:4},end:{line:87,column:7}},"42":{start:{line:80,column:8},end:{line:80,column:83}},"43":{start:{line:80,column:17},end:{line:80,column:83}},"44":{start:{line:82,column:8},end:{line:82,column:95}},"45":{start:{line:82,column:22},end:{line:82,column:95}},"46":{start:{line:85,column:8},end:{line:85,column:49}},"47":{start:{line:93,column:29},end:{line:93,column:42}},"48":{start:{line:94,column:4},end:{line:98,column:5}},"49":{start:{line:96,column:8},end:{line:96,column:70}},"50":{start:{line:100,column:15},end:{line:100,column:16}},"51":{start:{line:102,column:4},end:{line:104,column:5}},"52":{start:{line:103,column:8},end:{line:103,column:31}},"53":{start:{line:106,column:23},end:{line:106,column:24}},"54":{start:{line:108,column:4},end:{line:118,column:7}},"55":{start:{line:109,column:8},end:{line:109,column:83}},"56":{start:{line:109,column:17},end:{line:109,column:83}},"57":{start:{line:111,column:8},end:{line:111,column:95}},"58":{start:{line:111,column:22},end:{line:111,column:95}},"59":{start:{line:113,column:8},end:{line:117,column:11}},"60":{start:{line:123,column:19},end:{line:123,column:32}},"61":{start:{line:124,column:29},end:{line:124,column:42}},"62":{start:{line:125,column:4},end:{line:129,column:5}},"63":{start:{line:127,column:8},end:{line:127,column:70}},"64":{start:{line:131,column:4},end:{line:135,column:7}},"65":{start:{line:132,column:8},end:{line:132,column:64}},"66":{start:{line:134,column:8},end:{line:134,column:32}},"67":{start:{line:137,column:4},end:{line:137,column:45}},"68":{start:{line:139,column:4},end:{line:144,column:6}},"69":{start:{line:140,column:8},end:{line:140,column:77}},"70":{start:{line:140,column:17},end:{line:140,column:77}},"71":{start:{line:142,column:8},end:{line:142,column:71}},"72":{start:{line:148,column:17},end:{line:148,column:33}},"73":{start:{line:149,column:29},end:{line:149,column:42}},"74":{start:{line:150,column:4},end:{line:154,column:5}},"75":{start:{line:152,column:8},end:{line:152,column:70}},"76":{start:{line:157,column:15},end:{line:157,column:16}},"77":{start:{line:159,column:4},end:{line:161,column:5}},"78":{start:{line:160,column:8},end:{line:160,column:31}},"79":{start:{line:163,column:23},end:{line:163,column:24}},"80":{start:{line:166,column:4},end:{line:177,column:7}},"81":{start:{line:167,column:8},end:{line:167,column:83}},"82":{start:{line:167,column:17},end:{line:167,column:83}},"83":{start:{line:169,column:8},end:{line:169,column:95}},"84":{start:{line:169,column:22},end:{line:169,column:95}},"85":{start:{line:170,column:8},end:{line:174,column:11}},"86":{start:{line:181,column:0},end:{line:192,column:1}}},fnMap:{"0":{name:"artistSave",decl:{start:{line:10,column:9},end:{line:10,column:19}},loc:{start:{line:10,column:30},end:{line:37,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:30,column:16},end:{line:30,column:17}},loc:{start:{line:30,column:39},end:{line:36,column:5}},line:30},"2":{name:"updateArtist",decl:{start:{line:41,column:9},end:{line:41,column:21}},loc:{start:{line:41,column:32},end:{line:62,column:1}},line:41},"3":{name:"(anonymous_3)",decl:{start:{line:55,column:62},end:{line:55,column:63}},loc:{start:{line:55,column:86},end:{line:61,column:5}},line:55},"4":{name:"getArtist",decl:{start:{line:64,column:9},end:{line:64,column:18}},loc:{start:{line:64,column:29},end:{line:75,column:1}},line:64},"5":{name:"(anonymous_5)",decl:{start:{line:67,column:30},end:{line:67,column:31}},loc:{start:{line:67,column:47},end:{line:74,column:5}},line:67},"6":{name:"getArtists",decl:{start:{line:77,column:9},end:{line:77,column:19}},loc:{start:{line:77,column:30},end:{line:88,column:1}},line:77},"7":{name:"(anonymous_7)",decl:{start:{line:79,column:38},end:{line:79,column:39}},loc:{start:{line:79,column:56},end:{line:87,column:5}},line:79},"8":{name:"getArtistsPagination",decl:{start:{line:91,column:9},end:{line:91,column:29}},loc:{start:{line:91,column:40},end:{line:120,column:1}},line:91},"9":{name:"(anonymous_9)",decl:{start:{line:108,column:62},end:{line:108,column:63}},loc:{start:{line:108,column:87},end:{line:118,column:5}},line:108},"10":{name:"deleteArtist",decl:{start:{line:122,column:9},end:{line:122,column:21}},loc:{start:{line:122,column:32},end:{line:145,column:1}},line:122},"11":{name:"(anonymous_11)",decl:{start:{line:131,column:48},end:{line:131,column:49}},loc:{start:{line:131,column:59},end:{line:133,column:5}},line:131},"12":{name:"(anonymous_12)",decl:{start:{line:133,column:13},end:{line:133,column:14}},loc:{start:{line:133,column:22},end:{line:135,column:5}},line:133},"13":{name:"(anonymous_13)",decl:{start:{line:139,column:44},end:{line:139,column:45}},loc:{start:{line:139,column:51},end:{line:144,column:5}},line:139},"14":{name:"findByNombre",decl:{start:{line:147,column:9},end:{line:147,column:21}},loc:{start:{line:147,column:32},end:{line:179,column:1}},line:147},"15":{name:"(anonymous_15)",decl:{start:{line:166,column:108},end:{line:166,column:109}},loc:{start:{line:166,column:133},end:{line:177,column:5}},line:166}},branchMap:{"0":{loc:{start:{line:13,column:4},end:{line:17,column:5}},type:"if",locations:[{start:{line:13,column:4},end:{line:17,column:5}},{start:{line:13,column:4},end:{line:17,column:5}}],line:13},"1":{loc:{start:{line:19,column:4},end:{line:21,column:5}},type:"if",locations:[{start:{line:19,column:4},end:{line:21,column:5}},{start:{line:19,column:4},end:{line:21,column:5}}],line:19},"2":{loc:{start:{line:19,column:8},end:{line:19,column:91}},type:"binary-expr",locations:[{start:{line:19,column:8},end:{line:19,column:22}},{start:{line:19,column:26},end:{line:19,column:49}},{start:{line:19,column:53},end:{line:19,column:67}},{start:{line:19,column:71},end:{line:19,column:91}}],line:19},"3":{loc:{start:{line:31,column:8},end:{line:31,column:83}},type:"if",locations:[{start:{line:31,column:8},end:{line:31,column:83}},{start:{line:31,column:8},end:{line:31,column:83}}],line:31},"4":{loc:{start:{line:33,column:8},end:{line:33,column:107}},type:"if",locations:[{start:{line:33,column:8},end:{line:33,column:107}},{start:{line:33,column:8},end:{line:33,column:107}}],line:33},"5":{loc:{start:{line:46,column:4},end:{line:50,column:5}},type:"if",locations:[{start:{line:46,column:4},end:{line:50,column:5}},{start:{line:46,column:4},end:{line:50,column:5}}],line:46},"6":{loc:{start:{line:51,column:4},end:{line:53,column:5}},type:"if",locations:[{start:{line:51,column:4},end:{line:53,column:5}},{start:{line:51,column:4},end:{line:53,column:5}}],line:51},"7":{loc:{start:{line:51,column:8},end:{line:51,column:91}},type:"binary-expr",locations:[{start:{line:51,column:8},end:{line:51,column:22}},{start:{line:51,column:26},end:{line:51,column:49}},{start:{line:51,column:53},end:{line:51,column:67}},{start:{line:51,column:71},end:{line:51,column:91}}],line:51},"8":{loc:{start:{line:56,column:8},end:{line:56,column:83}},type:"if",locations:[{start:{line:56,column:8},end:{line:56,column:83}},{start:{line:56,column:8},end:{line:56,column:83}}],line:56},"9":{loc:{start:{line:58,column:8},end:{line:58,column:111}},type:"if",locations:[{start:{line:58,column:8},end:{line:58,column:111}},{start:{line:58,column:8},end:{line:58,column:111}}],line:58},"10":{loc:{start:{line:68,column:8},end:{line:68,column:77}},type:"if",locations:[{start:{line:68,column:8},end:{line:68,column:77}},{start:{line:68,column:8},end:{line:68,column:77}}],line:68},"11":{loc:{start:{line:70,column:8},end:{line:70,column:87}},type:"if",locations:[{start:{line:70,column:8},end:{line:70,column:87}},{start:{line:70,column:8},end:{line:70,column:87}}],line:70},"12":{loc:{start:{line:80,column:8},end:{line:80,column:83}},type:"if",locations:[{start:{line:80,column:8},end:{line:80,column:83}},{start:{line:80,column:8},end:{line:80,column:83}}],line:80},"13":{loc:{start:{line:82,column:8},end:{line:82,column:95}},type:"if",locations:[{start:{line:82,column:8},end:{line:82,column:95}},{start:{line:82,column:8},end:{line:82,column:95}}],line:82},"14":{loc:{start:{line:94,column:4},end:{line:98,column:5}},type:"if",locations:[{start:{line:94,column:4},end:{line:98,column:5}},{start:{line:94,column:4},end:{line:98,column:5}}],line:94},"15":{loc:{start:{line:102,column:4},end:{line:104,column:5}},type:"if",locations:[{start:{line:102,column:4},end:{line:104,column:5}},{start:{line:102,column:4},end:{line:104,column:5}}],line:102},"16":{loc:{start:{line:109,column:8},end:{line:109,column:83}},type:"if",locations:[{start:{line:109,column:8},end:{line:109,column:83}},{start:{line:109,column:8},end:{line:109,column:83}}],line:109},"17":{loc:{start:{line:111,column:8},end:{line:111,column:95}},type:"if",locations:[{start:{line:111,column:8},end:{line:111,column:95}},{start:{line:111,column:8},end:{line:111,column:95}}],line:111},"18":{loc:{start:{line:125,column:4},end:{line:129,column:5}},type:"if",locations:[{start:{line:125,column:4},end:{line:129,column:5}},{start:{line:125,column:4},end:{line:129,column:5}}],line:125},"19":{loc:{start:{line:140,column:8},end:{line:140,column:77}},type:"if",locations:[{start:{line:140,column:8},end:{line:140,column:77}},{start:{line:140,column:8},end:{line:140,column:77}}],line:140},"20":{loc:{start:{line:150,column:4},end:{line:154,column:5}},type:"if",locations:[{start:{line:150,column:4},end:{line:154,column:5}},{start:{line:150,column:4},end:{line:154,column:5}}],line:150},"21":{loc:{start:{line:159,column:4},end:{line:161,column:5}},type:"if",locations:[{start:{line:159,column:4},end:{line:161,column:5}},{start:{line:159,column:4},end:{line:161,column:5}}],line:159},"22":{loc:{start:{line:167,column:8},end:{line:167,column:83}},type:"if",locations:[{start:{line:167,column:8},end:{line:167,column:83}},{start:{line:167,column:8},end:{line:167,column:83}}],line:167},"23":{loc:{start:{line:169,column:8},end:{line:169,column:95}},type:"if",locations:[{start:{line:169,column:8},end:{line:169,column:95}},{start:{line:169,column:8},end:{line:169,column:95}}],line:169}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},b:{"0":[0,0],"1":[0,0],"2":[0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"92a3fbf072a1591cf48bd4ed30ca8eb1c01e8070"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_6056gmrza=function(){return actualCoverage;};return actualCoverage;}cov_6056gmrza();var mongoosePagination=(cov_6056gmrza().s[0]++,require('mongoose-pagination'));var Artist=(cov_6056gmrza().s[1]++,require('../models/artist'));var Song=(cov_6056gmrza().s[2]++,require('../models/song'));var Publication=(cov_6056gmrza().s[3]++,require('../models/publication'));function artistSave(req,res){cov_6056gmrza().f[0]++;var params=(cov_6056gmrza().s[4]++,req.body);var identity_user_role=(cov_6056gmrza().s[5]++,req.user.role);cov_6056gmrza().s[6]++;if(identity_user_role!='ROLE_ADMIN'){cov_6056gmrza().b[0][0]++;cov_6056gmrza().s[7]++;return res.status(403).send({message:'No tienes acceso.'});}else{cov_6056gmrza().b[0][1]++;}cov_6056gmrza().s[8]++;if((cov_6056gmrza().b[2][0]++,!params.nombre)||(cov_6056gmrza().b[2][1]++,!params.fechaNacimiento)||(cov_6056gmrza().b[2][2]++,!params.imagen)||(cov_6056gmrza().b[2][3]++,!params.nacionalidad)){cov_6056gmrza().b[1][0]++;cov_6056gmrza().s[9]++;return res.status(200).send({message:"Enviar datos necesarios."});}else{cov_6056gmrza().b[1][1]++;}var artist=(cov_6056gmrza().s[10]++,new Artist());cov_6056gmrza().s[11]++;artist.nombre=params.nombre;cov_6056gmrza().s[12]++;artist.fechaNacimiento=params.fechaNacimiento;cov_6056gmrza().s[13]++;artist.nacionalidad=params.nacionalidad;cov_6056gmrza().s[14]++;artist.imagen=params.imagen;cov_6056gmrza().s[15]++;artist.save((err,artistStored)=>{cov_6056gmrza().f[1]++;cov_6056gmrza().s[16]++;if(err){cov_6056gmrza().b[3][0]++;cov_6056gmrza().s[17]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_6056gmrza().b[3][1]++;}cov_6056gmrza().s[18]++;if(!artistStored){cov_6056gmrza().b[4][0]++;cov_6056gmrza().s[19]++;return res.status(404).send({message:'No se ha podido guardar el artista.'});}else{cov_6056gmrza().b[4][1]++;}cov_6056gmrza().s[20]++;return res.status(200).send({artist:artistStored});});}//Editar artista
function updateArtist(req,res){cov_6056gmrza().f[2]++;var artistId=(cov_6056gmrza().s[21]++,req.params.id);var update=(cov_6056gmrza().s[22]++,req.body);var identity_user_role=(cov_6056gmrza().s[23]++,req.user.role);cov_6056gmrza().s[24]++;if(identity_user_role!='ROLE_ADMIN'){cov_6056gmrza().b[5][0]++;cov_6056gmrza().s[25]++;return res.status(403).send({message:'No tienes acceso.'});}else{cov_6056gmrza().b[5][1]++;}cov_6056gmrza().s[26]++;if((cov_6056gmrza().b[7][0]++,!update.nombre)||(cov_6056gmrza().b[7][1]++,!update.fechaNacimiento)||(cov_6056gmrza().b[7][2]++,!update.imagen)||(cov_6056gmrza().b[7][3]++,!update.nacionalidad)){cov_6056gmrza().b[6][0]++;cov_6056gmrza().s[27]++;return res.status(200).send({message:"Enviar datos necesarios."});}else{cov_6056gmrza().b[6][1]++;}cov_6056gmrza().s[28]++;Artist.findByIdAndUpdate(artistId,update,{new:true},(err,artistUpdated)=>{cov_6056gmrza().f[3]++;cov_6056gmrza().s[29]++;if(err){cov_6056gmrza().b[8][0]++;cov_6056gmrza().s[30]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_6056gmrza().b[8][1]++;}cov_6056gmrza().s[31]++;if(!artistUpdated){cov_6056gmrza().b[9][0]++;cov_6056gmrza().s[32]++;return res.status(404).send({message:'No se ha podido actualizar el artista.'});}else{cov_6056gmrza().b[9][1]++;}cov_6056gmrza().s[33]++;return res.status(200).send({artist:artistUpdated});});}function getArtist(req,res){cov_6056gmrza().f[4]++;var artistId=(cov_6056gmrza().s[34]++,req.params.id);cov_6056gmrza().s[35]++;Artist.findById(artistId,(err,artist)=>{cov_6056gmrza().f[5]++;cov_6056gmrza().s[36]++;if(err){cov_6056gmrza().b[10][0]++;cov_6056gmrza().s[37]++;return res.status(500).send({message:'Error petición.'});}else{cov_6056gmrza().b[10][1]++;}cov_6056gmrza().s[38]++;if(!artist){cov_6056gmrza().b[11][0]++;cov_6056gmrza().s[39]++;return res.status(404).send({message:'El artista no existe.'});}else{cov_6056gmrza().b[11][1]++;}cov_6056gmrza().s[40]++;return res.status(200).send({artist:artist});});}//Artistas sin paginar.
function getArtists(req,res){cov_6056gmrza().f[6]++;cov_6056gmrza().s[41]++;Artist.find().sort('nombre').exec((err,artists)=>{cov_6056gmrza().f[7]++;cov_6056gmrza().s[42]++;if(err){cov_6056gmrza().b[12][0]++;cov_6056gmrza().s[43]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_6056gmrza().b[12][1]++;}cov_6056gmrza().s[44]++;if(!artists){cov_6056gmrza().b[13][0]++;cov_6056gmrza().s[45]++;return res.status(404).send({message:'No hay artistas disponibles.'});}else{cov_6056gmrza().b[13][1]++;}cov_6056gmrza().s[46]++;return res.status(200).send({artists});});}//Usuarios paginados
function getArtistsPagination(req,res){cov_6056gmrza().f[8]++;var identity_user_role=(cov_6056gmrza().s[47]++,req.user.role);cov_6056gmrza().s[48]++;if(identity_user_role!='ROLE_ADMIN'){cov_6056gmrza().b[14][0]++;cov_6056gmrza().s[49]++;return res.status(403).send({message:'No tienes acceso.'});}else{cov_6056gmrza().b[14][1]++;}var page=(cov_6056gmrza().s[50]++,1);cov_6056gmrza().s[51]++;if(req.params.page){cov_6056gmrza().b[15][0]++;cov_6056gmrza().s[52]++;page=req.params.page;}else{cov_6056gmrza().b[15][1]++;}var itemsPerPage=(cov_6056gmrza().s[53]++,6);cov_6056gmrza().s[54]++;Artist.find().sort('nombre').paginate(page,itemsPerPage,(err,artists,total)=>{cov_6056gmrza().f[9]++;cov_6056gmrza().s[55]++;if(err){cov_6056gmrza().b[16][0]++;cov_6056gmrza().s[56]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_6056gmrza().b[16][1]++;}cov_6056gmrza().s[57]++;if(!artists){cov_6056gmrza().b[17][0]++;cov_6056gmrza().s[58]++;return res.status(404).send({message:'No hay artistas disponibles.'});}else{cov_6056gmrza().b[17][1]++;}cov_6056gmrza().s[59]++;return res.status(200).send({artists,total,pages:Math.ceil(total/itemsPerPage)});});}function deleteArtist(req,res){cov_6056gmrza().f[10]++;var artistId=(cov_6056gmrza().s[60]++,req.params.id);var identity_user_role=(cov_6056gmrza().s[61]++,req.user.role);cov_6056gmrza().s[62]++;if(identity_user_role!='ROLE_ADMIN'){cov_6056gmrza().b[18][0]++;cov_6056gmrza().s[63]++;return res.status(403).send({message:'No tienes acceso.'});}else{cov_6056gmrza().b[18][1]++;}cov_6056gmrza().s[64]++;Song.find({artist:artistId}).exec().then(value=>{cov_6056gmrza().f[11]++;cov_6056gmrza().s[65]++;Publication.remove({"song":{"$in":value}}).exec();}).catch(err=>{cov_6056gmrza().f[12]++;cov_6056gmrza().s[66]++;return handleError(err);});cov_6056gmrza().s[67]++;Song.remove({artist:artistId}).exec();cov_6056gmrza().s[68]++;Artist.find({'_id':artistId}).remove(err=>{cov_6056gmrza().f[13]++;cov_6056gmrza().s[69]++;if(err){cov_6056gmrza().b[19][0]++;cov_6056gmrza().s[70]++;return res.status(500).send({message:'Error petición.'});}else{cov_6056gmrza().b[19][1]++;}cov_6056gmrza().s[71]++;return res.status(200).send({message:'Artista eliminado.'});});}function findByNombre(req,res){cov_6056gmrza().f[14]++;var nombre=(cov_6056gmrza().s[72]++,req.params.query);var identity_user_role=(cov_6056gmrza().s[73]++,req.user.role);cov_6056gmrza().s[74]++;if(identity_user_role!='ROLE_ADMIN'){cov_6056gmrza().b[20][0]++;cov_6056gmrza().s[75]++;return res.status(403).send({message:'No tienes acceso.'});}else{cov_6056gmrza().b[20][1]++;}var page=(cov_6056gmrza().s[76]++,1);cov_6056gmrza().s[77]++;if(req.params.page){cov_6056gmrza().b[21][0]++;cov_6056gmrza().s[78]++;page=req.params.page;}else{cov_6056gmrza().b[21][1]++;}var itemsPerPage=(cov_6056gmrza().s[79]++,5);cov_6056gmrza().s[80]++;Artist.find({"nombre":{'$regex':nombre,$options:'i'}}).sort('_id').paginate(page,itemsPerPage,(err,artists,total)=>{cov_6056gmrza().f[15]++;cov_6056gmrza().s[81]++;if(err){cov_6056gmrza().b[22][0]++;cov_6056gmrza().s[82]++;return res.status(500).send({message:'Error en la petición.'});}else{cov_6056gmrza().b[22][1]++;}cov_6056gmrza().s[83]++;if(!artists){cov_6056gmrza().b[23][0]++;cov_6056gmrza().s[84]++;return res.status(404).send({message:'No hay artistas disponibles.'});}else{cov_6056gmrza().b[23][1]++;}cov_6056gmrza().s[85]++;return res.status(200).send({artists,total,pages:Math.ceil(total/itemsPerPage)});});}cov_6056gmrza().s[86]++;module.exports={artistSave,getArtist,updateArtist,getArtists,getArtistsPagination,deleteArtist,findByNombre};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFydGlzdC5qcyJdLCJuYW1lcyI6WyJtb25nb29zZVBhZ2luYXRpb24iLCJyZXF1aXJlIiwiQXJ0aXN0IiwiU29uZyIsIlB1YmxpY2F0aW9uIiwiYXJ0aXN0U2F2ZSIsInJlcSIsInJlcyIsInBhcmFtcyIsImJvZHkiLCJpZGVudGl0eV91c2VyX3JvbGUiLCJ1c2VyIiwicm9sZSIsInN0YXR1cyIsInNlbmQiLCJtZXNzYWdlIiwibm9tYnJlIiwiZmVjaGFOYWNpbWllbnRvIiwiaW1hZ2VuIiwibmFjaW9uYWxpZGFkIiwiYXJ0aXN0Iiwic2F2ZSIsImVyciIsImFydGlzdFN0b3JlZCIsInVwZGF0ZUFydGlzdCIsImFydGlzdElkIiwiaWQiLCJ1cGRhdGUiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm5ldyIsImFydGlzdFVwZGF0ZWQiLCJnZXRBcnRpc3QiLCJmaW5kQnlJZCIsImdldEFydGlzdHMiLCJmaW5kIiwic29ydCIsImV4ZWMiLCJhcnRpc3RzIiwiZ2V0QXJ0aXN0c1BhZ2luYXRpb24iLCJwYWdlIiwiaXRlbXNQZXJQYWdlIiwicGFnaW5hdGUiLCJ0b3RhbCIsInBhZ2VzIiwiTWF0aCIsImNlaWwiLCJkZWxldGVBcnRpc3QiLCJ0aGVuIiwidmFsdWUiLCJyZW1vdmUiLCJjYXRjaCIsImhhbmRsZUVycm9yIiwiZmluZEJ5Tm9tYnJlIiwicXVlcnkiLCIkb3B0aW9ucyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLGEsOHdiQUVBLEdBQUlBLENBQUFBLGtCQUFrQix5QkFBR0MsT0FBTyxDQUFDLHFCQUFELENBQVYsQ0FBdEIsQ0FFQSxHQUFJQyxDQUFBQSxNQUFNLHlCQUFHRCxPQUFPLENBQUMsa0JBQUQsQ0FBVixDQUFWLENBQ0EsR0FBSUUsQ0FBQUEsSUFBSSx5QkFBR0YsT0FBTyxDQUFDLGdCQUFELENBQVYsQ0FBUixDQUNBLEdBQUlHLENBQUFBLFdBQVcseUJBQUdILE9BQU8sQ0FBQyx1QkFBRCxDQUFWLENBQWYsQ0FHQSxRQUFT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cEUsRUFBMkVNLFFBQTNFLENBQW9GRixJQUFwRixDQUEwRkMsWUFBMUYsQ0FBd0csQ0FBQ2xCLEdBQUQsQ0FBTWUsT0FBTixDQUFlSyxLQUFmLEdBQXlCLGlEQUM3SCxHQUFJcEIsR0FBSixDQUFTLDBEQUFPZixDQUFBQSxHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixDQUFFQyxPQUFPLENBQUUsdUJBQVgsQ0FBckIsQ0FBUCxDQUFrRSxDQUEzRSxpQ0FENkgsd0JBRzdILEdBQUksQ0FBQ3NCLE9BQUwsQ0FBYywwREFBTzlCLENBQUFBLEdBQUcsQ0FBQ00sTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCLENBQUVDLE9BQU8sQ0FBRSw4QkFBWCxDQUFyQixDQUFQLENBQXlFLENBQXZGLGlDQUg2SCx3QkFJN0gsTUFBT1IsQ0FBQUEsR0FBRyxDQUFDTSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsQ0FDeEJ1QixPQUR3QixDQUV4QkssS0FGd0IsQ0FHeEJDLEtBQUssQ0FBRUMsSUFBSSxDQUFDQyxJQUFMLENBQVVILEtBQUssQ0FBR0YsWUFBbEIsQ0FIaUIsQ0FBckIsQ0FBUCxDQU9ILENBWEQsRUFhSCxDLHdCQUVEZSxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsQ0FFYm5ELFVBRmEsQ0FHYjBCLFNBSGEsQ0FJYlAsWUFKYSxDQUtiUyxVQUxhLENBTWJLLG9CQU5hLENBT2JRLFlBUGEsQ0FRYk0sWUFSYSxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xyXG5cclxudmFyIG1vbmdvb3NlUGFnaW5hdGlvbiA9IHJlcXVpcmUoJ21vbmdvb3NlLXBhZ2luYXRpb24nKTtcclxuXHJcbnZhciBBcnRpc3QgPSByZXF1aXJlKCcuLi9tb2RlbHMvYXJ0aXN0Jyk7XHJcbnZhciBTb25nID0gcmVxdWlyZSgnLi4vbW9kZWxzL3NvbmcnKTtcclxudmFyIFB1YmxpY2F0aW9uID0gcmVxdWlyZSgnLi4vbW9kZWxzL3B1YmxpY2F0aW9uJyk7XHJcblxyXG5cclxuZnVuY3Rpb24gYXJ0aXN0U2F2ZShyZXEsIHJlcykge1xyXG4gICAgdmFyIHBhcmFtcyA9IHJlcS5ib2R5O1xyXG4gICAgdmFyIGlkZW50aXR5X3VzZXJfcm9sZSA9IHJlcS51c2VyLnJvbGU7XHJcbiAgICBpZiAoaWRlbnRpdHlfdXNlcl9yb2xlICE9ICdST0xFX0FETUlOJykge1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLnNlbmQoeyBtZXNzYWdlOiAnTm8gdGllbmVzIGFjY2Vzby4nIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXBhcmFtcy5ub21icmUgfHwgIXBhcmFtcy5mZWNoYU5hY2ltaWVudG8gfHwgIXBhcmFtcy5pbWFnZW4gfHwgIXBhcmFtcy5uYWNpb25hbGlkYWQpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBtZXNzYWdlOiBcIkVudmlhciBkYXRvcyBuZWNlc2FyaW9zLlwiIH0pXHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGFydGlzdCA9IG5ldyBBcnRpc3QoKTtcclxuXHJcbiAgICBhcnRpc3Qubm9tYnJlID0gcGFyYW1zLm5vbWJyZTtcclxuICAgIGFydGlzdC5mZWNoYU5hY2ltaWVudG8gPSBwYXJhbXMuZmVjaGFOYWNpbWllbnRvO1xyXG4gICAgYXJ0aXN0Lm5hY2lvbmFsaWRhZCA9IHBhcmFtcy5uYWNpb25hbGlkYWQ7XHJcbiAgICBhcnRpc3QuaW1hZ2VuID0gcGFyYW1zLmltYWdlbjtcclxuXHJcbiAgICBhcnRpc3Quc2F2ZSgoZXJyLCBhcnRpc3RTdG9yZWQpID0+IHtcclxuICAgICAgICBpZiAoZXJyKSByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBtZXNzYWdlOiAnRXJyb3IgZW4gbGEgcGV0aWNpw7NuLicgfSk7XHJcblxyXG4gICAgICAgIGlmICghYXJ0aXN0U3RvcmVkKSByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoeyBtZXNzYWdlOiAnTm8gc2UgaGEgcG9kaWRvIGd1YXJkYXIgZWwgYXJ0aXN0YS4nIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBhcnRpc3Q6IGFydGlzdFN0b3JlZCB9KTtcclxuICAgIH0pXHJcbn1cclxuXHJcbi8vRWRpdGFyIGFydGlzdGFcclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUFydGlzdChyZXEsIHJlcykge1xyXG4gICAgdmFyIGFydGlzdElkID0gcmVxLnBhcmFtcy5pZDtcclxuICAgIHZhciB1cGRhdGUgPSByZXEuYm9keTtcclxuICAgIHZhciBpZGVudGl0eV91c2VyX3JvbGUgPSByZXEudXNlci5yb2xlO1xyXG5cclxuICAgIGlmIChpZGVudGl0eV91c2VyX3JvbGUgIT0gJ1JPTEVfQURNSU4nKSB7XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuc2VuZCh7IG1lc3NhZ2U6ICdObyB0aWVuZXMgYWNjZXNvLicgfSk7XHJcblxyXG4gICAgfVxyXG4gICAgaWYgKCF1cGRhdGUubm9tYnJlIHx8ICF1cGRhdGUuZmVjaGFOYWNpbWllbnRvIHx8ICF1cGRhdGUuaW1hZ2VuIHx8ICF1cGRhdGUubmFjaW9uYWxpZGFkKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHsgbWVzc2FnZTogXCJFbnZpYXIgZGF0b3MgbmVjZXNhcmlvcy5cIiB9KVxyXG4gICAgfVxyXG5cclxuICAgIEFydGlzdC5maW5kQnlJZEFuZFVwZGF0ZShhcnRpc3RJZCwgdXBkYXRlLCB7IG5ldzogdHJ1ZSB9LCAoZXJyLCBhcnRpc3RVcGRhdGVkKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ0Vycm9yIGVuIGxhIHBldGljacOzbi4nIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFydGlzdFVwZGF0ZWQpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdObyBzZSBoYSBwb2RpZG8gYWN0dWFsaXphciBlbCBhcnRpc3RhLicgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IGFydGlzdDogYXJ0aXN0VXBkYXRlZCB9KTtcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEFydGlzdChyZXEsIHJlcykge1xyXG4gICAgdmFyIGFydGlzdElkID0gcmVxLnBhcmFtcy5pZDtcclxuXHJcbiAgICBBcnRpc3QuZmluZEJ5SWQoYXJ0aXN0SWQsIChlcnIsIGFydGlzdCkgPT4ge1xyXG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IG1lc3NhZ2U6ICdFcnJvciBwZXRpY2nDs24uJyB9KTtcclxuXHJcbiAgICAgICAgaWYgKCFhcnRpc3QpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdFbCBhcnRpc3RhIG5vIGV4aXN0ZS4nIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBhcnRpc3Q6IGFydGlzdCB9KVxyXG5cclxuICAgIH0pXHJcbn1cclxuLy9BcnRpc3RhcyBzaW4gcGFnaW5hci5cclxuZnVuY3Rpb24gZ2V0QXJ0aXN0cyhyZXEsIHJlcykge1xyXG5cclxuICAgIEFydGlzdC5maW5kKCkuc29ydCgnbm9tYnJlJykuZXhlYygoZXJyLCBhcnRpc3RzKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ0Vycm9yIGVuIGxhIHBldGljacOzbi4nIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFydGlzdHMpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdObyBoYXkgYXJ0aXN0YXMgZGlzcG9uaWJsZXMuJyB9KTtcclxuXHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7IGFydGlzdHMgfSk7XHJcblxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vVXN1YXJpb3MgcGFnaW5hZG9zXHJcbmZ1bmN0aW9uIGdldEFydGlzdHNQYWdpbmF0aW9uKHJlcSwgcmVzKSB7XHJcblxyXG4gICAgdmFyIGlkZW50aXR5X3VzZXJfcm9sZSA9IHJlcS51c2VyLnJvbGU7XHJcbiAgICBpZiAoaWRlbnRpdHlfdXNlcl9yb2xlICE9ICdST0xFX0FETUlOJykge1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLnNlbmQoeyBtZXNzYWdlOiAnTm8gdGllbmVzIGFjY2Vzby4nIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB2YXIgcGFnZSA9IDE7XHJcblxyXG4gICAgaWYgKHJlcS5wYXJhbXMucGFnZSkge1xyXG4gICAgICAgIHBhZ2UgPSByZXEucGFyYW1zLnBhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGl0ZW1zUGVyUGFnZSA9IDY7XHJcblxyXG4gICAgQXJ0aXN0LmZpbmQoKS5zb3J0KCdub21icmUnKS5wYWdpbmF0ZShwYWdlLCBpdGVtc1BlclBhZ2UsIChlcnIsIGFydGlzdHMsIHRvdGFsKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ0Vycm9yIGVuIGxhIHBldGljacOzbi4nIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWFydGlzdHMpIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdObyBoYXkgYXJ0aXN0YXMgZGlzcG9uaWJsZXMuJyB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5zZW5kKHtcclxuICAgICAgICAgICAgYXJ0aXN0cyxcclxuICAgICAgICAgICAgdG90YWwsXHJcbiAgICAgICAgICAgIHBhZ2VzOiBNYXRoLmNlaWwodG90YWwgLyBpdGVtc1BlclBhZ2UpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUFydGlzdChyZXEsIHJlcykge1xyXG4gICAgdmFyIGFydGlzdElkID0gcmVxLnBhcmFtcy5pZDtcclxuICAgIHZhciBpZGVudGl0eV91c2VyX3JvbGUgPSByZXEudXNlci5yb2xlO1xyXG4gICAgaWYgKGlkZW50aXR5X3VzZXJfcm9sZSAhPSAnUk9MRV9BRE1JTicpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKHsgbWVzc2FnZTogJ05vIHRpZW5lcyBhY2Nlc28uJyB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgU29uZy5maW5kKHsgYXJ0aXN0OiBhcnRpc3RJZCB9KS5leGVjKCkudGhlbigodmFsdWUpID0+IHtcclxuICAgICAgICBQdWJsaWNhdGlvbi5yZW1vdmUoeyBcInNvbmdcIjogeyBcIiRpblwiOiB2YWx1ZSB9IH0pLmV4ZWMoKTtcclxuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICByZXR1cm4gaGFuZGxlRXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG5cclxuICAgIFNvbmcucmVtb3ZlKHsgYXJ0aXN0OiBhcnRpc3RJZCB9KS5leGVjKCk7XHJcblxyXG4gICAgQXJ0aXN0LmZpbmQoeyAnX2lkJzogYXJ0aXN0SWQgfSkucmVtb3ZlKGVyciA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ0Vycm9yIHBldGljacOzbi4nIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoeyBtZXNzYWdlOiAnQXJ0aXN0YSBlbGltaW5hZG8uJyB9KTtcclxuXHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBmaW5kQnlOb21icmUocmVxLCByZXMpIHtcclxuICAgIHZhciBub21icmUgPSByZXEucGFyYW1zLnF1ZXJ5O1xyXG4gICAgdmFyIGlkZW50aXR5X3VzZXJfcm9sZSA9IHJlcS51c2VyLnJvbGU7XHJcbiAgICBpZiAoaWRlbnRpdHlfdXNlcl9yb2xlICE9ICdST0xFX0FETUlOJykge1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLnNlbmQoeyBtZXNzYWdlOiAnTm8gdGllbmVzIGFjY2Vzby4nIH0pO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgdmFyIHBhZ2UgPSAxO1xyXG5cclxuICAgIGlmIChyZXEucGFyYW1zLnBhZ2UpIHtcclxuICAgICAgICBwYWdlID0gcmVxLnBhcmFtcy5wYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBpdGVtc1BlclBhZ2UgPSA1O1xyXG5cclxuXHJcbiAgICBBcnRpc3QuZmluZCh7IFwibm9tYnJlXCI6IHsgJyRyZWdleCc6IG5vbWJyZSwgJG9wdGlvbnM6ICdpJyB9IH0pLnNvcnQoJ19pZCcpLnBhZ2luYXRlKHBhZ2UsIGl0ZW1zUGVyUGFnZSwgKGVyciwgYXJ0aXN0cywgdG90YWwpID0+IHtcclxuICAgICAgICBpZiAoZXJyKSByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoeyBtZXNzYWdlOiAnRXJyb3IgZW4gbGEgcGV0aWNpw7NuLicgfSk7XHJcblxyXG4gICAgICAgIGlmICghYXJ0aXN0cykgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKHsgbWVzc2FnZTogJ05vIGhheSBhcnRpc3RhcyBkaXNwb25pYmxlcy4nIH0pO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuc2VuZCh7XHJcbiAgICAgICAgICAgIGFydGlzdHMsXHJcbiAgICAgICAgICAgIHRvdGFsLFxyXG4gICAgICAgICAgICBwYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gaXRlbXNQZXJQYWdlKVxyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICB9KTtcclxuXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgIGFydGlzdFNhdmUsXHJcbiAgICBnZXRBcnRpc3QsXHJcbiAgICB1cGRhdGVBcnRpc3QsXHJcbiAgICBnZXRBcnRpc3RzLFxyXG4gICAgZ2V0QXJ0aXN0c1BhZ2luYXRpb24sXHJcbiAgICBkZWxldGVBcnRpc3QsXHJcbiAgICBmaW5kQnlOb21icmVcclxuXHJcblxyXG59Il19